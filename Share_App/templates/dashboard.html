{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - SharePlate</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col min-h-screen font-sans bg-gray-50">

  <!-- Navbar -->
  <header class="bg-white shadow-md py-4 px-10 flex items-center justify-between z-10">
    <div>
      <img src="{% static 'images/logo.png' %}" alt="SharePlate Logo" class="h-11 md:h-12">
    </div>
    <nav class="space-x-6">
      <a href="{% url 'home' %}" class="text-green-800 font-semibold hover:text-green-500 transition">Home</a>
      <a href="{% url 'about' %}" class="text-green-800 font-semibold hover:text-green-500 transition">About</a>
      <a href="{% url 'contact' %}" class="text-green-800 font-semibold hover:text-green-500 transition">Contact</a>
    </nav>
  </header>

  <!-- Hero Background -->
  <div class="relative bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80');">
    <div class="absolute inset-0 bg-green-600 bg-opacity-60 backdrop-blur-sm"></div>
    <div class="relative z-10 container mx-auto py-16">
      <h1 class="text-white text-4xl md:text-5xl font-bold text-center mb-12">Welcome to Your Dashboard</h1>

      <div class="grid md:grid-cols-2 gap-8">
        <!-- Share Food -->
        <div class="bg-white bg-opacity-95 rounded-xl shadow-xl p-8 text-center transition transform hover:-translate-y-2">
          <h2 class="text-2xl font-bold mb-4">üç≤ Share Food</h2>
          <p class="text-gray-700 mb-6">Donate your extra food and turn a simple meal into hope and happiness for someone in need. ‚ù§Ô∏è</p>
          <a href="{% url 'share_food' %}" class="inline-block px-6 py-3 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition">Share Food</a>
        </div>

        <!-- Share Location -->
        <div class="bg-white bg-opacity-95 rounded-xl shadow-xl p-8 text-center transition transform hover:-translate-y-2">
          <h2 class="text-2xl font-bold mb-4">üìç Share Location</h2>
          <p class="text-gray-700 mb-6">Share the location of those in need and help deliver hope, food, and care to hearts that need it most. ‚ù§Ô∏è</p>
          <a href="{% url 'share_location' %}" class="inline-block px-6 py-3 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition">Share Location</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container mx-auto px-4 py-10 grid md:grid-cols-3 gap-8">

    <!-- Food Details -->
    <div class="md:col-span-1 bg-white rounded-xl shadow p-6 overflow-y-auto max-h-[600px]">
      <h3 class="text-xl font-bold mb-4 text-center">üç¥ Food Details</h3>
      <div class="space-y-4">
        {% if food_items %}
          {% for food in food_items %}
            <div class="bg-gray-100 border-l-4 border-green-500 rounded-lg p-4 hover:bg-green-50 transition">
              <strong class="text-lg">{{ food.food_name }}</strong><br>
              Quantity: {{ food.quantity }}<br>
              {% if food.expiry_date %}
                Expiry Date: {{ food.expiry_date|date:"M d, Y" }}<br>
              {% endif %}
              <small class="text-gray-500">
                Donor: {{ food.donor.username }}
                {% if food.donor_phone %} | üìû {{ food.donor_phone }}{% endif %}
              </small><br>

              {% if food.photo %}
                <img src="{{ food.photo.url }}" alt="{{ food.food_name }}" class="mt-2 rounded max-w-full h-auto shadow">
              {% endif %}

              {% if food.latitude and food.longitude %}
                <a href="https://www.google.com/maps?q={{ food.latitude }},{{ food.longitude }}" target="_blank" class="text-green-500 font-semibold hover:underline mt-2 inline-block">
                  üìç View Location
                </a><br>
              {% endif %}

              <small class="text-gray-400">
                Added on {{ food.created_at|date:"M d, Y H:i" }}
              </small><br>

              {% if food.donor == request.user %}
                <form method="post" action="{% url 'delete_food' food.pk %}" onsubmit="return confirm('Are you sure you want to delete this item?');" class="mt-2">
                  {% csrf_token %}
                  <button type="submit" class="px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition">Delete</button>
                </form>
              {% endif %}
            </div>
          {% endfor %}
        {% else %}
          <p class="text-center text-gray-500">No food shared yet.</p>
        {% endif %}
      </div>
    </div>

    <!-- Location Details -->
    <div class="md:col-span-2 bg-white rounded-xl shadow p-6 overflow-y-auto max-h-[600px]">
      <h3 class="text-xl font-bold mb-4 text-center">üìç Shared Locations</h3>
      <div class="space-y-4">
        {% if needy_locations %}
          {% for loc in needy_locations %}
            <div class="bg-gray-100 border-l-4 border-green-500 rounded-lg p-4 hover:bg-green-50 transition">
              <strong>{{ loc.place_name }}</strong><br>
              Added by: {{ loc.sender_name }}
              {% if loc.phone_number %} | üìû {{ loc.phone_number }}{% endif %}<br>
              {% if loc.photo %}
                <img src="{{ loc.photo.url }}" alt="{{ loc.place_name }}" class="rounded my-2 max-h-40 object-cover w-full">
              {% endif %}
              {% if loc.latitude and loc.longitude %}
                <a href="https://www.google.com/maps?q={{ loc.latitude }},{{ loc.longitude }}" target="_blank" class="text-green-500 font-semibold hover:underline mt-2 inline-block">
                  üìç View Location
                </a><br>
              {% endif %}
              <small class="text-gray-400">
                Added on {{ loc.created_at|date:"M d, Y H:i" }}
              </small><br>
              {% if loc.added_by == request.user %}
                <form method="post" action="{% url 'delete_location' loc.pk %}" onsubmit="return confirm('Are you sure you want to delete this location?');" class="mt-2">
                  {% csrf_token %}
                  <button type="submit" class="px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600 transition">Delete</button>
                </form>
              {% endif %}
            </div>
          {% endfor %}
        {% else %}
          <p class="text-center text-gray-500">No locations shared yet.</p>
        {% endif %}
      </div>
    </div>

  </div>

  <!-- Footer -->
  <footer class="bg-gray-900 text-gray-300 text-center py-6 mt-auto">
    <p>SharePlate brings together hearts willing to give and those in need. Every shared meal and location is a step towards a kinder world. ‚ù§Ô∏è</p>
  </footer>

</body>
</html>
